{{extend 'layout.html'}} <h2 align="center">Summary Report</h2> <h3 align="center">Repair & Maintenance Expenses</h3> {{=form}} {{if grand_total > 0:}}{{=LOAD('FuelReports', 'btn_report.load', ajax=False)}}{{pass}} </br></br> <div id="target_warpper"><div id="target"> <table width = '100%'> <tr> <td valign="top" width="60%"> {{=table}} </td> <td width = '2%'></td> <td valign="top" width = '38%'> {{=i}} </td> </tr> </table> </div> </div> {{if grand_total > 0:}} <div id="com_chart" style="min-width: 310px; height: 400px; margin: 0 auto"></div> <div id="div_chart" style="min-width: 310px; height: 400px; margin: 0 auto"></div> <div id="dept_chart" style="min-width: 310px; height: 400px; margin: 0 auto"></div> {{pass}} <script type="text/javascript">function PrintContent(){var b=document.getElementById("target_warpper"),a=window.open("","PrintWindow","width = 1100,height=700,top=50,left=50,toolbars=no,scrollbars=yes,status=no,resizable=yes");a.document.writeln("<!DOCTYPE html>");a.document.writeln("<html><head><title>Vehicle Management System Report</title>");a.document.writeln('<link rel="stylesheet" type="text/css" href="{{=URL("static", "css/tablereport.css")}}">');a.document.writeln('</head><body style = "font-size:80%;font-family: Tahoma, Arial, serif; margin:10px;width:98%;height:100%;">'); a.document.writeln("<h1 align = center>Darwish Group</h1>");a.document.writeln("<h2 align = center>Vehicle Management System</h2>");a.document.writeln("<h3 align = center>Summary Report</h3>");a.document.writeln("<h4 align = center>Company Maintenance Expenses</h4>");a.document.writeln(b.innerHTML);a.document.writeln("</body></html>");a.document.close();a.focus();a.print();a.close()};</script> <script type="text/javascript"> $(function () { $('#com_chart').highcharts({ chart: { type: 'column'}, title: { text: 'Summary Chart' }, subtitle: { text: 'Company Repair & Maintenance Expenses: {{=form.vars.start_date.strftime("%Y/%m/%d") if form.vars.start_date else 0}} - {{=form.vars.end_date.strftime("%Y/%m/%d") if form.vars.end_date else 0}}' }, xAxis: { categories: [ {{for y in q_company:}} '{{=y.vehicle.company_id.company}}', {{pass}} ] }, yAxis: { min: 0, title: { text: 'Expenses' } }, tooltip: { headerFormat: '<span style="font-size:10px">Company: {point.key}</span><table>', pointFormat: '<tr><td style="font-size:10px; color:{series.color};padding:0">{series.name}: </td>' + '<td style="font-size:10px;padding:0"><b>{point.y}</b></td></tr>', footerFormat: '</table>', shared: true, useHTML: true }, plotOptions: { column: { pointPadding: 0.2, borderWidth: 0 } }, credits: {enabled: false}, series: [{ name: 'Grand Total', data: [ {{for x in q_company:}} {{=x[total_amount]}}, {{pass}} ] }] }); }); $(function () { $('#div_chart').highcharts({ chart: { type: 'column'}, title: { text: 'Summary Chart' }, subtitle: { text: 'Division Repair & Maintenance Expenses: {{=form.vars.start_date.strftime("%Y/%m/%d") if form.vars.start_date else 0}} - {{=form.vars.end_date.strftime("%Y/%m/%d") if form.vars.end_date else 0}}' }, xAxis: { categories: [ {{for y in q_division:}} '{{=y.vehicle.division_id.division}}', {{pass}} ] }, yAxis: { min: 0, title: { text: 'Expenses' } }, tooltip: { headerFormat: '<span style="font-size:10px">Division: {point.key}</span><table>', pointFormat: '<tr><td style="font-size:10px; color:{series.color};padding:0">{series.name}: </td>' + '<td style="font-size:10px;padding:0"><b>{point.y}</b></td></tr>', footerFormat: '</table>', shared: true, useHTML: true }, plotOptions: { column: { pointPadding: 0.2, borderWidth: 0 } }, credits: {enabled: false}, series: [{ name: 'Total Amount', data: [ {{for x in q_division:}} {{=x[total_amount]}}, {{pass}} ], color: '#BBD9EE', }] }); }); $(function () { $('#dept_chart').highcharts({ chart: { type: 'column'}, title: { text: 'Summary Chart' }, subtitle: { text: 'Department Repair & Maintenance Expenses: {{=form.vars.start_date.strftime("%Y/%m/%d") if form.vars.start_date else 0}} - {{=form.vars.end_date.strftime("%Y/%m/%d") if form.vars.end_date else 0}}' }, xAxis: { categories: [ {{for y in q_department:}} '{{=y.vehicle.department.name}}', {{pass}} ] }, yAxis: { min: 0, title: { text: 'Expenses' } }, tooltip: { headerFormat: '<span style="font-size:10px">Department: {point.key}</span><table>', pointFormat: '<tr><td style="font-size:10px; color:{series.color};padding:0">{series.name}: </td>' + '<td style="font-size:10px;padding:0"><b>{point.y}</b></td></tr>', footerFormat: '</table>', shared: true, useHTML: true }, plotOptions: { column: { pointPadding: 0.2, borderWidth: 0 } }, credits: {enabled: false}, series: [{ name: 'Total Amount', data: [ {{for x in q_department:}} {{=x[total_amount]}}, {{pass}} ], color: '#E7E4D3', }] }); }); </script>