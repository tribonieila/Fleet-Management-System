{{extend 'layout.html'}}<h2 align="center">Summary Report</h2><h3 align="center">Fuel Expenses</h3>{{=form}}{{if grand_total > 0:}}{{=LOAD('FuelReports', 'btn_report.load', ajax=False)}}{{pass}}</br></br><div id="target_warpper"><div id="target"><table width='100%'><tr><td valign="top" width="60%">{{=table}}</td><td width='2%'></td><td valign="top" width='38%'>{{=i}}</td></tr></table></div></div>{{if grand_total > 0:}}<div id="com_chart" style="min-width:310px;height:400px;margin:0 auto"></div><div id="div_chart" style="min-width:310px;height:400px;margin:0 auto"></div><div id="dept_chart" style="min-width:310px;height:400px;margin:0 auto"></div>{{pass}}
<script type=text/javascript>function PrintContent()
{var DocumentContainer=document.getElementById('target_warpper');var WindowObject=window.open('','PrintWindow','width = 1100,height=700,top=50,left=50,toolbars=no,scrollbars=yes,status=no,resizable=yes');WindowObject.document.writeln('<!DOCTYPE html>');WindowObject.document.writeln('<html><head><title>Vehicle Management System Report</title>');WindowObject.document.writeln('<link rel="stylesheet" type="text/css" href="{{=URL("static", "css/tablereport.css")}}">');WindowObject.document.writeln('</head><body style = "font-size:80%;font-family: Tahoma, Arial, serif; margin:10px;width:98%;height:100%;">')
WindowObject.document.writeln('<img src="{{=URL("static", "images/header_report.jpg")}}"></img>')
WindowObject.document.writeln('<hr></br>')
WindowObject.document.writeln('<h2 align = center>Fuel Expenses Summary Report</h2>')
WindowObject.document.writeln(DocumentContainer.innerHTML);WindowObject.document.writeln('</body></html>');WindowObject.document.close();WindowObject.focus();WindowObject.print();WindowObject.close();}</script>
<script type=text/javascript>$(function(){$('#com_chart').highcharts({chart:{type:'column'},title:{text:'Summary Chart'},subtitle:{text:'Company Fuel Expenditures: {{=form.vars.start_date.strftime("%Y/%m/%d") if form.vars.start_date else 0}} - {{=form.vars.end_date.strftime("%Y/%m/%d") if form.vars.end_date else 0}}'},xAxis:{categories:[{{for y in q_company:}}'{{=y.vehicle.company_id.company}}',{{pass}}]},yAxis:{min:0,title:{text:'Expenses'}},tooltip:{headerFormat:'<span style="font-size:10px">Company: {point.key}</span><table>',pointFormat:'<tr><td style="font-size:10px; color:{series.color};padding:0">{series.name}: </td>'+'<td style="font-size:10px;padding:0"><b>{point.y}</b></td></tr>',footerFormat:'</table>',shared:true,useHTML:true},plotOptions:{column:{pointPadding:0.2,borderWidth:0}},credits:{enabled:false},series:[{name:'Grand Total',data:[{{for x in q_company:}}
{{=x[total_amount]}},{{pass}}]}]});});$(function(){$('#div_chart').highcharts({chart:{type:'column'},title:{text:'Summary Chart'},subtitle:{text:'Division Fuel Expenditures: {{=form.vars.start_date.strftime("%Y/%m/%d") if form.vars.start_date else 0}} - {{=form.vars.end_date.strftime("%Y/%m/%d") if form.vars.end_date else 0}}'},xAxis:{categories:[{{for y in q_division:}}'{{=y.vehicle.division_id.division}}',{{pass}}]},yAxis:{min:0,title:{text:'Expenses'}},tooltip:{headerFormat:'<span style="font-size:10px">Division: {point.key}</span><table>',pointFormat:'<tr><td style="font-size:10px; color:{series.color};padding:0">{series.name}: </td>'+'<td style="font-size:10px;padding:0"><b>{point.y}</b></td></tr>',footerFormat:'</table>',shared:true,useHTML:true},plotOptions:{column:{pointPadding:0.2,borderWidth:0}},credits:{enabled:false},series:[{name:'Total Amount',data:[{{for x in q_division:}}
{{=x[total_amount]}},{{pass}}],color:'#BBD9EE',}]});});$(function(){$('#dept_chart').highcharts({chart:{type:'column'},title:{text:'Summary Chart'},subtitle:{text:'Department Fuel Expenditures: {{=form.vars.start_date.strftime("%Y/%m/%d") if form.vars.start_date else 0}} - {{=form.vars.end_date.strftime("%Y/%m/%d") if form.vars.end_date else 0}}'},xAxis:{categories:[{{for y in q_department:}}'{{=y.vehicle.department.name}}',{{pass}}]},yAxis:{min:0,title:{text:'Expenses'}},tooltip:{headerFormat:'<span style="font-size:10px">Department: {point.key}</span><table>',pointFormat:'<tr><td style="font-size:10px; color:{series.color};padding:0">{series.name}: </td>'+'<td style="font-size:10px;padding:0"><b>{point.y}</b></td></tr>',footerFormat:'</table>',shared:true,useHTML:true},plotOptions:{column:{pointPadding:0.2,borderWidth:0}},credits:{enabled:false},series:[{name:'Total Amount',data:[{{for x in q_department:}}
{{=x[total_amount]}},{{pass}}],color:'#E7E4D3',}]});});</script>