{{extend 'layout.html'}}<h2 align="center">Company Fuel Expenses Report</h2>{{=form}}{{if grand_total > 0:}}{{=LOAD('FuelReports', 'btn_report.load', ajax=False)}}{{pass}}</br></br><div id="target_warpper"><div id="target"><table width='100%'><tr><td valign="top" width="50%">{{=table}}</td><td width='2%'></td><td valign="top" width='48%'>{{=i}}</td></tr></table></div></div>{{if grand_total > 0:}}<div id="com_chart" style="min-width:310px;height:400px;margin:0 auto"></div>{{pass}}
<script type=text/javascript>function PrintContent()
{var DocumentContainer=document.getElementById('target_warpper');var WindowObject=window.open('','PrintWindow','width = 1100,height=700,top=50,left=50,toolbars=no,scrollbars=yes,status=no,resizable=yes');WindowObject.document.writeln('<!DOCTYPE html>');WindowObject.document.writeln('<html><head><title>Vehicle Management System Report</title>');WindowObject.document.writeln('<link rel="stylesheet" type="text/css" href="{{=URL("static", "css/tablereport.css")}}">');WindowObject.document.writeln('</head><body style = "font-size:80%;font-family: Tahoma, Arial, serif; margin:10px;width:98%;height:100%;">')
WindowObject.document.writeln('<img src="{{=URL("static", "images/header_report.jpg")}}"></img>')
WindowObject.document.writeln('<hr></br>')
WindowObject.document.writeln('<h2 align = center>Fuel Expenses Report</h2>')
WindowObject.document.writeln(DocumentContainer.innerHTML);WindowObject.document.writeln('</body></html>');WindowObject.document.close();WindowObject.focus();WindowObject.print();WindowObject.close();}
$(function(){$('#com_chart').highcharts({chart:{type:'column'},title:{text:'Summary Chart'},subtitle:{text:'Company Fuel Expenses: {{=form.vars.start_date.strftime("%Y/%m/%d") if form.vars.start_date else 0}} - {{=form.vars.end_date.strftime("%Y/%m/%d") if form.vars.end_date else 0}}'},xAxis:{categories:[{{for y in c_query:}}'{{=y.fuel_expenses.reg_no_id.reg_no}}',{{pass}}]},yAxis:{min:0,title:{text:'Expenses'}},tooltip:{headerFormat:'<span style="font-size:10px">Reg.No.: {point.key}</span><table>',pointFormat:'<tr><td style="font-size:10px; color:{series.color};padding:0">{series.name}: </td>'+'<td style="font-size:10px;padding:0"><b>{point.y}</b></td></tr>',footerFormat:'</table>',shared:true,useHTML:true},plotOptions:{column:{pointPadding:0.2,borderWidth:0}},credits:{enabled:false},series:[{name:'Mileage',data:[{{for x in c_query:}}{{=x.vehicle.mileage or 0}},{{pass}}]},{name:'Amount',data:[{{for y in c_query:}}{{=y._extra['sum(fuel_expenses.amount)']or 0}},{{pass}}]}]});});</script>